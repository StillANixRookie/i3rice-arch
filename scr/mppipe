#!/usr/bin/env bash

# OA: Gavin Vales
# CREATED: Sat 26 Jan 21:59:12 GMT 2019

VID="$1"
FIFO="$USER_TMP_DIR/MPV${2:-"MAIN"}"
PID="$(pgrep -f "${FIFO##*/}")"

if [[ -n ${PID} ]]; then
	echo "loadfile \"${VID}\"" append-play > "${FIFO}"
	echo "$VID" >> ${FIFO}list
else
	rm "${FIFO}"
	rm "${FIFO}list"
	mkfifo "${FIFO}"
	mpv --input-file="${FIFO}" "${VID}" &>/dev/null &
	echo "$VID" > ${FIFO}list
fi
